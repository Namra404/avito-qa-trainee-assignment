# Тест-кейсы для микросервиса объявлений

**baseUrl:** `https://qa-internship.avito.com`

---

## API v1

## 1) POST /api/1/item - Создание объявления

### TC-001: Успешное создание объявления

**Предусловия:** нет  
**Шаги:**

1. Отправить `POST` на `{{baseUrl}}/api/1/item`.
2. Передать валидный JSON:

```json
{
  "sellerID": "<integer>",
  "name": "<string>",
  "price": "<integer>",
  "statistics": {
    "likes": "<integer>",
    "viewCount": "<integer>",
    "contacts": "<integer>"
  }
}
```

**Ожидаемый результат:**

- Status code: `200`
- В ответе присутствуют поля: `id`, `sellerId`, `name`, `price`, `statistics.likes`, `statistics.viewCount`,
  `statistics.contacts`, `createdAt`.
- `createdAt` - дата/время создания объявления.

---

### Негативные тесты

#### TC-002: Попытка создать объявление без тела запроса

**Предусловия:** нет  
**Шаги:** отправить `POST` на `{{baseUrl}}/api/1/item` без body.  
**Ожидаемый результат:**

- Status code: `400`

```json
{
  "result": {
    "message": "",
    "messages": {}
  },
  "status": "не передан объект - объявление"
}
```

#### TC-003: Попытка создать объявление без поля `likes` в `statistics`

**Предусловия:** нет  
**Шаги:** отправить валидное body, но без `statistics.likes`:

```json
{
  "sellerID": "<integer>",
  "name": "<string>",
  "price": "<integer>",
  "statistics": {
    "viewCount": "<integer>",
    "contacts": "<integer>"
  }
}
```

**Ожидаемый результат:**

- Status code: `400`

```json
{
  "result": {
    "message": "поле likes обязательно",
    "messages": {}
  },
  "status": "400"
}
```

#### TC-004: Попытка создать объявление без поля `viewCount` в `statistics`

**Предусловия:** нет  
**Шаги:** отправить body без `statistics.viewCount`.  
**Ожидаемый результат:** Status code `400`, сообщение `поле viewCount обязательно`.

#### TC-005: Попытка создать объявление без поля `contacts` в `statistics`

**Предусловия:** нет  
**Шаги:** отправить body без `statistics.contacts`.  
**Ожидаемый результат:** Status code `400`, сообщение `поле contacts обязательно`.

---

### Остальные негативные тесты (компактно)

> Во всех кейсах ниже берётся валидный запрос из TC‑001 но применяется указанное изменение.

| ID     | Название                                           | Изменение в запросе               | Ожидаемый результат |
|--------|----------------------------------------------------|-----------------------------------|---------------------|
| TC-006 | Попытка создать объявление с пустым JSON           | `{}`                              | `400`               |
| TC-007 | Попытка создать объявление без блока `statistics`  | удалить поле `statistics` целиком | `400`               |
| TC-008 | `sellerID` отсутствует                             | удалить поле `sellerID`           | `400`               |
| TC-009 | `Попытка создать объявление с `sellerID = null`    | `"sellerID": null`                | `400`               |
| TC-010 | `sellerID` неверного типа                          | `"sellerID": "210800"`            | `400`               |
| TC-011 | `Попытка создать объявление с `sellerID = 0``      | `"sellerID": 0`                   | `400`               |
| TC-012 | `sellerID` отрицательный                           | `"sellerID": -1`                  | `400`               |
| TC-013 | `name` отсутствует                                 | удалить поле `name`               | `400`               |
| TC-014 | `Попытка создать объявление с `name = null``       | `"name": null`                    | `400`               |
| TC-015 | `name` пустая строка                               | `"name": ""`                      | `400`               |
| TC-016 | `name` неверного типа                              | `"name": 123`                     | `400`               |
| TC-017 | `price` отсутствует                                | удалить поле `price`              | `400`               |
| TC-018 | `Попытка создать объявление с `price = null``      | `"price": null`                   | `400`               |
| TC-019 | `price` неверного типа                             | `"price": "1000"`                 | `400`               |
| TC-020 | `price` отрицательный                              | `"price": -1000`                  | `400`               |
| TC-021 | `Попытка создать объявление с `price = 0``         | `"price": 0`                      | `400`               |
| TC-022 | `price` дробный                                    | `"price": 1000.5`                 | `400`               |
| TC-023 | `Попытка создать объявление с `statistics = null`` | `"statistics": null`              | `400`               |
| TC-024 | `statistics` неверного типа (строка)               | `"statistics": "bad"`             | `400`               |
| TC-025 | `statistics` неверного типа (массив)               | `"statistics": []`                | `400`               |
| TC-026 | `Попытка создать объявление с `likes = null``      | `"likes": null`                   | `400`               |
| TC-027 | `Попытка создать объявление с `viewCount = null``  | `"viewCount": null`               | `400`               |
| TC-028 | `Попытка создать объявление с `contacts = null``   | `"contacts": null`                | `400`               |
| TC-029 | `likes` неверного типа                             | `"likes": "1"`                    | `400`               |
| TC-030 | `viewCount` неверного типа                         | `"viewCount": "1"`                | `400`               |
| TC-031 | `contacts` неверного типа                          | `"contacts": "1"`                 | `400`               |
| TC-032 | `likes` отрицательный                              | `"likes": -1`                     | `400`               |
| TC-033 | `viewCount` отрицательный                          | `"viewCount": -1`                 | `400`               |
| TC-034 | `contacts` отрицательный                           | `"contacts": -1`                  | `400`               |

---

## 2) GET /api/1/item/:id - Получение объявления по идентификатору

### TC-035: Успешное получение объявления по идентификатору

**Предусловия:** существует объявление с `id = "<UUID>"`  
**Шаги:** отправить `GET` на `{{baseUrl}}/api/1/item/<existing_id>`.  
**Ожидаемый результат:**

- Status code: `200`
- Тело - JSON-массив с объектом(ами) объявления, где есть поля `id`, `sellerId`, `name`, `price`, `statistics.*`,
  `createdAt`.

### Негативные тесты

#### TC-036: Попытка получить объявление по некорректному id (не UUID)

**Предусловия:** нет  
**Шаги:** отправить `GET` на `{{baseUrl}}/api/1/item/<invalidId>`.  
**Ожидаемый результат:**

- Status code: `400`

```json
{
  "result": {
    "message": "ID айтема не UUID: <invalidId>",
    "messages": {}
  },
  "status": "400"
}
```

#### TC-037: Попытка получить объявление по несуществующему UUID

**Предусловия:** нет  
**Шаги:** отправить `GET` на `{{baseUrl}}/api/1/item/<non-existent uuid>`.  
**Ожидаемый результат:**

- Status code: `404`

```json
{
  "result": "item <non-existent id> not found",
  "status": "404"
}
```

### Остальные негативные тесты (компактно)

| ID     | Название                                          | Данные                         | Ожидаемый результат                            |
|--------|---------------------------------------------------|--------------------------------|------------------------------------------------|
| TC-038 | Попытка получить объявление без подстановки id    | запрос с `:id` без подстановки | `400`, сообщение вида `ID айтема не UUID: :id` |
| TC-039 | Попытка получить объявление с id со спецсимволами | `%0A!@`                        | `400`, `ID айтема не UUID: ...`                |
| TC-040 | Попытка получить объявление с id как SQL-инъекция | `' OR '1'='1' --`              | `400`, `ID айтема не UUID: drop database;`     |
| TC-041 | Попытка получить объявление с слишком длинным id  | 500–2000+ символов             | `400`, `ID айтема не UUID: <...>`              |

---

## 3) GET /api/1/statistic/:id - Получение статистики по объявлению

### TC-042: Успешное получение статистики по объявлению

**Предусловия:** существует объявление с `id = "<UUID>"`  
**Шаги:** отправить `GET` на `{{baseUrl}}/api/1/statistic/<existing_id>`.  
**Ожидаемый результат:**

- Status code: `200`
- Тело - JSON-массив объектов со статистикой: `likes`, `viewCount`, `contacts` (тип данных у них int).

### Негативные тесты (ключевые, с примером ответа)

#### TC-043: Попытка получить статистику по некорректному id

**Шаги:** отправить `GET` на `{{baseUrl}}/api/1/statistic/<invalidId>`.  
**Ожидаемый результат:**

- Status code: `400`

```json
{
  "result": {
    "message": "передан некорректный идентификатор объявления",
    "messages": {}
  },
  "status": "400"
}
```

#### TC-044: Статистика по несуществующему объявлению (id валидный)

**Шаги:** отправить `GET` на `{{baseUrl}}/api/1/statistic/<non-existent uuid>`.  
**Ожидаемый результат:**

- Status code: `404`

```json
{
  "result": "statistic <id> not found",
  "status": "404"
}
```

### Негативные тесты (остальные, компактно)

| ID     | Название                                         | Данные                                     | Ожидаемый результат |
|--------|--------------------------------------------------|--------------------------------------------|---------------------|
| TC-045 | Попытка получить статистику без подстановки id   | `GET /api/1/statistic/:id` без подстановки | `400`               |
| TC-046 | Попытка получить статистику с слишком длинным id | 700 символов                               | `400`               |

---

## 4) GET /api/1/:sellerID/item - Получение всех объявлений пользователя

### TC-047: Успешное получение всех объявлений пользователя

**Предусловия:** существует продавец с валидным `sellerID`  
**Шаги:** отправить `GET` на `{{baseUrl}}/api/1/<sellerID>/item`.  
**Ожидаемый результат:**

- Status code: `200`
- Тело - JSON-массив объявлений продавца.

### Негативные тесты

#### TC-048: Попытка получить объявления продавца по некорректному sellerID

**Шаги:** отправить `GET` на `{{baseUrl}}/api/1/<invalidSellerID>/item`.  
**Ожидаемый результат:**

- Status code: `400`

```json
{
  "result": {
    "message": "передан некорректный идентификатор продавца",
    "messages": {}
  },
  "status": "400"
}
```

### Остальные негативные тесты (компактно)

| ID     | Название                                                                         | Данные                 | Ожидаемый результат |
|--------|----------------------------------------------------------------------------------|------------------------|---------------------|
| TC-049 | Попытка получить объявления продавца с дробным sellerID                          | GET /api/1/123.45/item | `400`               |
| TC-050 | Попытка получить объявления продавца с sellerID из пробелов                      | `" "`                  | `400`               |
| TC-051 | Попытка получить объявления продавца, когда sellerID содержит # (ломает роутинг) | `#`                    | `404`               |
| TC-052 | Попытка получить объявления продавца с слишком длинным sellerID                  | 500–2000+ символов     | `400`               |
| TC-053 | Попытка получить объявления продавца с отрицательным sellerID                    | `-1`                   | `400`               |

---

## ДОПОЛНИТЕЛЬНО API v2

## 5) GET /api/2/statistic/:id - Получение статистики по объявлению (v2)

### TC-054: Успешное получение статистики по объявлению (v2)

**Шаги:** отправить `GET` на `{{baseUrl}}/api/2/statistic/<existing_id>`.  
**Ожидаемый результат:** Status code `200`, тело - массив объектов со статистикой (`likes`, `viewCount`, `contacts`).

### TC-055: Статистика по несуществующему объявлению (валидный id) (v2)

**Шаги:** отправить `GET` на `{{baseUrl}}/api/2/statistic/<non-existent uuid>`.  
**Ожидаемый результат:** Status code `404`.

### TC-056: Статистика по объявлению с некорректным id (v2)

**Шаги:** отправить `GET` на `{{baseUrl}}/api/2/statistic/invalidId`.  
**Ожидаемый результат:** Status code `404`.

### TC-057: Статистика по объявлению со слишком длинным id (v2)

**Шаги:** отправить `GET` на `{{baseUrl}}/api/2/statistic/<very_long_string>`.  
**Ожидаемый результат:** Status code `404`.

---

## 6) DELETE /api/2/item/:id - Удаление объявления по идентификатору (v2)

### TC-058: Успешное удаление объявления по идентификатору (v2)

**Предусловия:** существует объявление с `id = "<UUID>"`  
**Шаги:** отправить `DELETE` на `{{baseUrl}}/api/2/item/<existing_id>`.  
**Ожидаемый результат:** Status code `200`.

### TC-059: Попытка удалить объявления по некорректному id (v2 delete)

**Шаги:** отправить `DELETE` на `{{baseUrl}}/api/2/item/<invalidId>`.  
**Ожидаемый результат:** Status code `400`.

### TC-060: Попытка удалить объявления по несуществующему но валидному id (v2 delete)

**Шаги:** отправить `DELETE` на `{{baseUrl}}/api/2/item/<non-existent uuid>`.  
**Ожидаемый результат:** Status code `404`.

---



